#Bash command file to process GRIB file data:


MIN=1980
MAX=1981
FILEnoYEAR="_ERA5_US"

for (( c=$MIN; c<=$MAX; c++ ))
do  
    echo "Year: $c"

    #Create an unformatted CSV file:
	grib_get_data -p dataDate,dataTime,validityDate,validityTime,shortName Data/"$c"${FILEnoYEAR}.grib > Data/"$c"${FILEnoYEAR}_unformatted.csv
    echo "Saved unformatted csv file"

    #Format the csv file to a proper table:
    python ../1_Build_Value_Table_ERA5.py Data/"$c"${FILEnoYEAR}_unformatted.csv Data/"$c"${FILEnoYEAR}_uncompressed.csv
    echo "Formatted CSV file to proper table."

    #Remove unformatted csv file:
    rm Data/"$c"${FILEnoYEAR}_unformatted.csv
    echo "Removed unformatted csv file"

    #Build the value ordered per measurement to a data table where all measurements per data point are joined in one row:
    python ../2_Build_Data_Table_ERA5.py Data/"$c"${FILEnoYEAR}_uncompressed.csv Data/"$c"${FILEnoYEAR}.pickle

    #Remove uncompressed file:
    rm Data/"$c"${FILEnoYEAR}_uncompressed.csv
    echo "Removed uncompressed file"

echo "Process completed"